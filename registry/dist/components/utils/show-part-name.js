!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports["utils/show-part-name"]=t():e["utils/show-part-name"]=t()}(self,(function(){return function(){var e,t,n={658:function(e,t,n){var i=n(645)((function(e){return e[1]}));i.push([e.id,"#bilibiliShowPN-be {\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  overflow: hidden;\n  margin-left: 16px;\n}",""]),e.exports=i},645:function(e){"use strict";
// eslint-disable-next-line func-names
e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=e(t);return t[2]?"@media ".concat(t[2]," {").concat(n,"}"):n})).join("")},
// eslint-disable-next-line func-names
t.i=function(e,n,i){"string"==typeof e&&(
// eslint-disable-next-line no-param-reassign
e=[[null,e,""]]);var r={};if(i)for(var o=0;o<this.length;o++){
// eslint-disable-next-line prefer-destructuring
var a=this[o][0];null!=a&&(r[a]=!0)}for(var s=0;s<e.length;s++){var u=[].concat(e[s]);i&&r[u[0]]||(n&&(u[2]?u[2]="".concat(n," and ").concat(u[2]):u[2]=n),t.push(u))}},t}},828:function(e,t,n){var i=n(658);e.exports="string"==typeof i?i:i.toString()},569:function(e){"use strict";e.exports=coreApis.spinQuery}},i={};function r(e){var t=i[e];if(void 0!==t)return t.exports;var o=i[e]={id:e,exports:{}};return n[e](o,o.exports,r),o.exports}r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,{a:t}),t},t=Object.getPrototypeOf?function(e){return Object.getPrototypeOf(e)}:function(e){return e.__proto__},r.t=function(n,i){if(1&i&&(n=this(n)),8&i)return n;if("object"==typeof n&&n){if(4&i&&n.__esModule)return n;if(16&i&&"function"==typeof n.then)return n}var o=Object.create(null);r.r(o);var a={};e=e||[null,t({}),t([]),t(t)];for(var s=2&i&&n;"object"==typeof s&&!~e.indexOf(s);s=t(s))Object.getOwnPropertyNames(s).forEach((function(e){a[e]=function(){return n[e]}}));return a.default=function(){return n},r.d(o,a),o},r.d=function(e,t){for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var o={};return function(){"use strict";r.d(o,{component:function(){return y}});var e=coreApis.style,t=coreApis.utils.urls,n=coreApis.observer,i=r(828),a=r.n(i),s=r(569),u=coreApis.utils,c=coreApis.pluginApis.data;const l=e=>fetch(`https://api.bilibili.com/x/web-interface/view?aid=${e}`).then((e=>e.json())),d=async()=>{if(unsafeWindow.aid)return unsafeWindow.aid;const{sq:e}=await Promise.resolve().then(r.t.bind(r,569,23)),t=await e((()=>unsafeWindow?.player?.getVideoMessage?.()),(e=>void 0!==e?.aid));return t?(unsafeWindow.aid=t.aid.toString(),t.aid):null},f={showInNewLine:!1},p=async e=>{if(document.querySelector("#bilibiliShowInfos"))return;let t;await(0,u.playerReady)();const[n]=(0,c.registerAndGetData)("showPartName",f),i="bilibiliShowPN-be";if(location.pathname.startsWith("/medialist")){let{aid:n}=e;if(!n){n=(await(0,s.select)(".player-auxiliary-playlist-item-active")).getAttribute("data-aid")}t=(await l(n)).data}else t=e.vd||(await l(await d())).data;var r,o;console.log("showid debug",e,e.vd,t,(await(r=e.bvid,fetch(`https://api.bilibili.com/x/web-interface/view?bvid=${r}`).then((e=>e.json())))).data,(await l(await d())).data),t.p=(o="p",new URL(location.href).searchParams.get(o)||((e,t)=>{if(!e||!t||!t.pages)return 1;if(1===t.pages.length)return 1;for(const n of t.pages)if(n&&n.cid===e)return n.page;return 1})(e.cid,t));const a=await(0,s.select)(".video-data");if(!a)return;let p,v;if(n.showInNewLine)p=((e,t)=>{let n=document.querySelector(`#${e}`);return n||(n=document.createElement("span"),n.id=e,t.appendChild(n)),n})(i,a.parentElement);else{let e=document.querySelector(`#${i}`);e||(e=document.createElement("span"),e.id=i,a.appendChild(e)),p=e}try{v=t.pages[t.p-1]}catch(e){v=t.pages[0]}const h=v.part.length?`${v.part}`:"";let y,w;1!==t.videos?(y=`P ${t.p}/${t.videos}`,w=["\n"," "]):(y="",w=["",""]),p.title=y+w[0]+h,p.innerText=y+w[1]+h},v="showPartName",h=()=>{(0,e.addStyle)(a(),v),(0,n.videoChange)((async()=>{p(unsafeWindow)}))},y={name:v,entry:h,reload:h,unload:()=>{(0,e.removeStyle)(v)},displayName:"显示视频分P名",tags:[componentsTags.video,componentsTags.utils],description:{"zh-CN":"在视频信息栏显示分P名"},urlInclude:t.videoUrls}}(),o=o.component}()}));